# チャット機能テスト手順

## テスト環境の準備

チャット機能をテストするには、**2つのブラウザ**（または通常モードとシークレットモード）で異なるアカウントでログインする必要があります。

---

## 方法1: 新規アカウントを作成してテスト（推奨）

### Step 1: 1つ目のアカウントを作成

1. https://stackmankai-zeta.vercel.app/customer-auth にアクセス
2. 「新規登録」タブをクリック
3. 以下の情報を入力:
   - メールアドレス: `chattest1@example.com`
   - パスワード: `test1234`
   - パスワード確認: `test1234`
4. 「無料で登録する」ボタンをクリック
5. ログイン後、「店舗を選択」画面で店舗510（テストポーカー店）を選択

### Step 2: 2つ目のアカウントを作成

1. **シークレットモード**で新しいブラウザウィンドウを開く
2. https://stackmankai-zeta.vercel.app/customer-auth にアクセス
3. 「新規登録」タブをクリック
4. 以下の情報を入力:
   - メールアドレス: `chattest2@example.com`
   - パスワード: `test1234`
   - パスワード確認: `test1234`
5. 「無料で登録する」ボタンをクリック
6. ログイン後、「店舗を選択」画面で店舗510（テストポーカー店）を選択

### Step 3: チャットにアクセス

**両方のブラウザで:**
1. customer-viewページに移動（ログイン後自動的にリダイレクトされる）
2. 画面右上のメニューボタン（☰）をクリック
3. 「チャット」を選択

### Step 4: メッセージを送信

1. **ブラウザ1**でメッセージを入力して送信
2. **ブラウザ2**でリアルタイムにメッセージが表示されることを確認
3. **ブラウザ2**でメッセージを入力して送信
4. **ブラウザ1**でリアルタイムにメッセージが表示されることを確認

---

## 方法2: 既存のアカウントでテスト

既に顧客アカウントを持っている場合は、そのアカウントを使用してテストできます。

### 条件
- 両方のアカウントが**同じ店舗をホームに設定**している必要があります
- 異なる店舗のアカウントではチャットが表示されません

### 手順

1. **ブラウザ1**で既存のアカウントでログイン
2. **ブラウザ2（シークレットモード）**で別の既存のアカウントでログイン
3. 両方のブラウザでメニューから「チャット」を選択
4. メッセージを送信して、リアルタイムで同期されることを確認

---

## 確認項目

### ✅ 基本機能
- [ ] メッセージが送信できる
- [ ] メッセージがリアルタイムで表示される
- [ ] 自分のメッセージと他人のメッセージが区別される
- [ ] 送信時刻が表示される
- [ ] 送信者名が表示される

### ✅ UI/UX
- [ ] メッセージ入力欄が表示される
- [ ] 送信ボタンが機能する
- [ ] Enterキーで送信できる
- [ ] 新しいメッセージが追加されたら自動スクロールする
- [ ] モバイルでも正常に表示される

### ✅ データ分離
- [ ] 同じ店舗のプレイヤーのみがメッセージを見られる
- [ ] 他店舗のメッセージは表示されない

---

## トラブルシューティング

### メッセージが送信できない

**原因:**
- ログインしていない
- 店舗をホームに設定していない
- Firebase接続エラー

**解決方法:**
1. ログイン状態を確認
2. customer-viewページで店舗が選択されているか確認
3. ブラウザのコンソールでエラーを確認

### メッセージがリアルタイムで表示されない

**原因:**
- Firestoreリアルタイム更新の接続エラー
- ブラウザのキャッシュ

**解決方法:**
1. ページをリロード（Ctrl+Shift+R）
2. ブラウザのキャッシュをクリア
3. ブラウザのコンソールでエラーを確認

### 他のユーザーのメッセージが表示されない

**原因:**
- 異なる店舗に所属している
- 店舗IDが正しく設定されていない

**解決方法:**
1. 両方のアカウントが同じ店舗をホームに設定しているか確認
2. customer-viewページで店舗名を確認

---

## テスト完了後

テストが完了したら、以下の情報を記録してください:

- [ ] メッセージ送信が成功したか
- [ ] リアルタイム同期が動作したか
- [ ] エラーが発生したか（発生した場合はエラーメッセージを記録）
- [ ] UI/UXに問題がなかったか

---

## 注意事項

- テストアカウントは本番環境で作成されます
- テスト後もアカウントは削除されません
- テストメッセージは実際のFirestoreに保存されます
- 不要なアカウントは後で削除できます

---

## サポート

テスト中に問題が発生した場合は、以下の情報を提供してください:

1. エラーメッセージ
2. ブラウザのコンソールログ
3. 使用したアカウント情報
4. 実行した手順

これにより、問題を迅速に解決できます。
